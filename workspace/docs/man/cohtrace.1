.\" CLASSIFICATION: COMMUNITY
.\" Filename: cohtrace.1 v0.3
.\" Author: Lukas Bower
.\" Date Modified: 2029-03-08
.TH COHTRACE 1 "2029-03-08" "Cohesix v1.0" "Cohesix Project"
.SH NAME
cohtrace \- trace inspection utilities
.SH SYNOPSIS
.B cohtrace
.I command
.RI [ options ]
.SH DESCRIPTION
Inspect and manipulate validator traces, snapshots, and orchestration state. The
utility provides subcommands for listing workers, comparing snapshots, pushing
trace files, and reading queen/worker status from the active registry.
.SH COMMANDS
.TP
.B list
List connected workers discovered under \fI/srv/workers\fR.
.TP
.BI "push-trace " worker_id " " path
Copy a trace file at \fIpath\fR into \fI/trace/worker_id/sim.json\fR.
.TP
.B diff
Compare the two most recent snapshot JSON files under \fI/history/snapshots\fR
and print a human-readable diff.
.TP
.B cloud
Display queen identity, validator state, and active workers via the
\fIcohesix.orchestrator.OrchestratorService\fR gRPC API. Falls back to
\fI/srv/cloud/state.json\fR and \fI/srv/agents/active.json\fR if the
service is unavailable.
.SH FILES
.TP
.B /history/snapshots
Stores the most recent validator snapshots.
.TP
.B /srv/agents/active.json
Legacy JSON mirror of the active worker registry maintained for
backwards compatibility.
.TP
.B /srv/cloud/state.json
Last reported queen heartbeat and worker summary.
.TP
.B /etc/cohtrace_rules.json
Path normalization rules enforced by \fBcohtrace diff\fR. The file must provide
an \fIallowed_roots\fR array and optional \fIrewrites\fR entries. The
environment variable \fBCOHTRACE_RULES_PATH\fR overrides the default location.
.SH CONFIGURATION
\fBcohtrace diff\fR validates trace access against the configured rules file.
Invalid schemas or paths outside \fIallowed_roots\fR result in a taxonomy exit
code (see below) and the diff is aborted.
.SH EXIT STATUS
.TP
.B 0
Snapshots match; no drift detected.
.TP
.B 30
Drift detected between the most recent snapshots.
.TP
.B 31
Insufficient snapshots available to compute a diff.
.TP
.B 32
Rule violation or unreadable rules file encountered while preparing the diff.
.SH EXAMPLES
.TP
.B cohtrace list
List all discovered workers.
.TP
.B cohtrace diff
Show the differences between the two most recent snapshots.
.TP
.B cohtrace cloud
Summarize queen status, worker roles, and heartbeat health.
.SH SEE ALSO
.BR cohrun (1),
.BR cohcli (1)
