# Author: Lukas Bower
# Purpose: Regression manifest enabling host/policy/audit/replay surfaces for cohsh scripts.
[meta]
author = "Lukas Bower"
purpose = "Regression manifest enabling host/policy/audit/replay surfaces."

[root_task]
schema = "1.2"

[profile]
name = "virt-aarch64"
kernel = true

[event_pump]
tick_ms = 5

[secure9p]
msize = 8192
walk_depth = 8
tags_per_session = 16
batch_frames = 1

[secure9p.short_write]
policy = "reject"

[cache]
kernel_ops = true
dma_clean = true
dma_invalidate = true
unify_instructions = false

[features]
net_console = true
serial_console = true
std_console = false
std_host_tools = false

[namespaces]
role_isolation = true

[sharding]
enabled = true
shard_bits = 8
legacy_worker_alias = true

[telemetry]
ring_bytes_per_worker = 1024
frame_schema = "legacy-plaintext"

[telemetry.cursor]
retain_on_boot = false

[[tickets]]
role = "queen"
secret = "bootstrap"

[[tickets]]
role = "worker-heartbeat"
secret = "worker"

[[tickets]]
role = "worker-gpu"
secret = "worker-gpu"

[ecosystem.host]
enable = true
providers = ["systemd", "k8s"]
mount_at = "/host"

[ecosystem.audit]
enable = true
journal_max_bytes = 8192
decisions_max_bytes = 4096
replay_enable = true
replay_max_entries = 64
replay_ctl_max_bytes = 1024
replay_status_max_bytes = 1024

[ecosystem.policy]
enable = true
queue_max_entries = 32
queue_max_bytes = 4096
ctl_max_bytes = 2048
status_max_bytes = 512

[[ecosystem.policy.rules]]
id = "queen-ctl"
target = "/queen/ctl"

[[ecosystem.policy.rules]]
id = "systemd-restart"
target = "/host/systemd/*/restart"

[ecosystem.models]
enable = false
