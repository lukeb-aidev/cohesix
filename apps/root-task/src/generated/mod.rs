// Author: Lukas Bower
// Purpose: Generated root-task manifest tables and helpers.
// @generated by coh-rtc; do not edit.

#![allow(clippy::all)]
#![allow(dead_code)]

use cohesix_ticket::Role;

mod bootstrap;

#[derive(Clone, Copy, Debug)]
pub struct TicketSpec {
    pub role: Role,
    pub secret: &'static str,
}

#[derive(Clone, Copy, Debug)]
pub struct NamespaceMount {
    pub service: &'static str,
    pub target: &'static [&'static str],
}

#[derive(Clone, Copy, Debug)]
pub struct CachePolicy {
    pub kernel_ops: bool,
    pub dma_clean: bool,
    pub dma_invalidate: bool,
    pub unify_instructions: bool,
}

#[derive(Clone, Copy, Debug)]
pub enum ShortWritePolicy {
    Reject,
    Retry,
}

#[derive(Clone, Copy, Debug)]
pub struct Secure9pLimits {
    pub msize: u32,
    pub walk_depth: u8,
    pub tags_per_session: u16,
    pub batch_frames: u16,
    pub short_write_policy: ShortWritePolicy,
}

#[derive(Clone, Copy, Debug)]
pub enum TelemetryFrameSchema {
    LegacyPlaintext,
    CborV1,
}

#[derive(Clone, Copy, Debug)]
pub struct TelemetryCursorConfig {
    pub retain_on_boot: bool,
}

#[derive(Clone, Copy, Debug)]
pub struct TelemetryConfig {
    pub ring_bytes_per_worker: u32,
    pub frame_schema: TelemetryFrameSchema,
    pub cursor: TelemetryCursorConfig,
}

#[derive(Clone, Copy, Debug, PartialEq, Eq)]
pub enum HostProvider {
    Systemd,
    K8s,
    Nvidia,
    Jetson,
    Net,
}

#[derive(Clone, Copy, Debug)]
pub struct HostConfig {
    pub enable: bool,
    pub mount_at: &'static str,
    pub providers: &'static [HostProvider],
}

#[derive(Clone, Copy, Debug)]
pub struct PolicyRule {
    pub id: &'static str,
    pub target: &'static str,
}

#[derive(Clone, Copy, Debug)]
pub struct PolicyLimits {
    pub queue_max_entries: u16,
    pub queue_max_bytes: u32,
    pub ctl_max_bytes: u32,
    pub status_max_bytes: u32,
}

#[derive(Clone, Copy, Debug)]
pub struct PolicyConfig {
    pub enable: bool,
    pub limits: PolicyLimits,
    pub rules: &'static [PolicyRule],
}

#[derive(Clone, Copy, Debug)]
pub struct AuditConfig {
    pub enable: bool,
    pub journal_max_bytes: u32,
    pub decisions_max_bytes: u32,
    pub replay_enable: bool,
    pub replay_max_entries: u16,
    pub replay_ctl_max_bytes: u32,
    pub replay_status_max_bytes: u32,
}

pub const MANIFEST_SCHEMA: &str = "1.2";
pub const MANIFEST_SHA256: &str = "6f58dd705b235b26f0b3524f4a5d632d664015be6338c06e4953257ea0c83413";
pub const TICKET_TABLE_SHA256: &str = bootstrap::TICKET_TABLE_SHA256;
pub const NAMESPACE_TABLE_SHA256: &str = bootstrap::NAMESPACE_TABLE_SHA256;
pub const AUDIT_TABLE_SHA256: &str = bootstrap::AUDIT_TABLE_SHA256;
pub const CACHE_POLICY: CachePolicy = bootstrap::CACHE_POLICY;
pub const SECURE9P_LIMITS: Secure9pLimits = bootstrap::SECURE9P_LIMITS;
pub const TELEMETRY_CONFIG: TelemetryConfig = bootstrap::TELEMETRY_CONFIG;
pub const HOST_CONFIG: HostConfig = bootstrap::HOST_CONFIG;
pub const POLICY_CONFIG: PolicyConfig = bootstrap::POLICY_CONFIG;
pub const POLICY_RULES_JSON: &str = bootstrap::POLICY_RULES_JSON;
pub const AUDIT_CONFIG: AuditConfig = bootstrap::AUDIT_CONFIG;
pub const EVENT_PUMP_FDS: &[&str] = &bootstrap::EVENT_PUMP_FDS;

pub const fn ticket_inventory() -> &'static [TicketSpec] {
    &bootstrap::TICKET_INVENTORY
}

pub const fn namespace_mounts() -> &'static [NamespaceMount] {
    &bootstrap::NAMESPACE_MOUNTS
}

pub const fn initial_audit_lines() -> &'static [&'static str] {
    &bootstrap::INITIAL_AUDIT_LINES
}

pub const fn cache_policy() -> CachePolicy {
    bootstrap::CACHE_POLICY
}

pub const fn secure9p_limits() -> Secure9pLimits {
    bootstrap::SECURE9P_LIMITS
}

pub const fn telemetry_config() -> TelemetryConfig {
    bootstrap::TELEMETRY_CONFIG
}

pub const fn host_config() -> HostConfig {
    bootstrap::HOST_CONFIG
}

pub const fn policy_config() -> PolicyConfig {
    bootstrap::POLICY_CONFIG
}

pub const fn policy_rules_json() -> &'static str {
    bootstrap::POLICY_RULES_JSON
}

pub const fn audit_config() -> AuditConfig {
    bootstrap::AUDIT_CONFIG
}

pub const fn event_pump_fds() -> &'static [&'static str] {
    &bootstrap::EVENT_PUMP_FDS
}

pub const TICKET_COUNT: usize = bootstrap::TICKET_INVENTORY.len();
