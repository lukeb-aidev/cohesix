// Author: Lukas Bower
// Purpose: Generated manifest tables for root-task bootstrap.
// @generated by coh-rtc; do not edit.

use super::{AuditConfig, CachePolicy, HostConfig, HostProvider, NamespaceMount, PolicyConfig, PolicyLimits, PolicyRule, Secure9pLimits, ShortWritePolicy, TelemetryConfig, TelemetryCursorConfig, TelemetryFrameSchema, TicketSpec};
use cohesix_ticket::Role;

pub const TICKET_TABLE_SHA256: &str = "4841a3b409199c285eff46bb5dac457f745f5cf6e55216bd45a14d56d91556da";
pub const NAMESPACE_TABLE_SHA256: &str = "4f53cda18c2baa0c0354bb5f9a3ecbe5ed12ab4d8e11ba873c2f11161202b945";
pub const AUDIT_TABLE_SHA256: &str = "2ddbaa39096ad05f36ef14b4b7f353a1accab6a4f38fd9baabb9a9b42b39d7f1";

pub const TICKET_INVENTORY: [TicketSpec; 3] = [
    TicketSpec { role: Role::Queen, secret: "bootstrap" },
    TicketSpec { role: Role::WorkerHeartbeat, secret: "worker" },
    TicketSpec { role: Role::WorkerGpu, secret: "worker-gpu" },
];

pub const NAMESPACE_MOUNTS: [NamespaceMount; 0] = [
];

pub const CACHE_POLICY: CachePolicy = CachePolicy { kernel_ops: true, dma_clean: true, dma_invalidate: true, unify_instructions: false };

pub const SECURE9P_LIMITS: Secure9pLimits = Secure9pLimits { msize: 8192, walk_depth: 8, tags_per_session: 16, batch_frames: 1, short_write_policy: ShortWritePolicy::Reject };

pub const TELEMETRY_CONFIG: TelemetryConfig = TelemetryConfig { ring_bytes_per_worker: 1024, frame_schema: TelemetryFrameSchema::LegacyPlaintext, cursor: TelemetryCursorConfig { retain_on_boot: false } };

pub const HOST_PROVIDERS: [HostProvider; 0] = [
];

pub const HOST_CONFIG: HostConfig = HostConfig { enable: false, mount_at: "/host", providers: &HOST_PROVIDERS };

pub const POLICY_RULES: [PolicyRule; 2] = [
    PolicyRule { id: "queen-ctl", target: "/queen/ctl" },
    PolicyRule { id: "systemd-restart", target: "/host/systemd/*/restart" },
];

pub const POLICY_CONFIG: PolicyConfig = PolicyConfig { enable: false, limits: PolicyLimits { queue_max_entries: 32, queue_max_bytes: 4096, ctl_max_bytes: 2048, status_max_bytes: 512 }, rules: &POLICY_RULES };

pub const POLICY_RULES_JSON: &str = "{\n  \"enabled\": false,\n  \"limits\": {\n    \"queue_max_entries\": 32,\n    \"queue_max_bytes\": 4096,\n    \"ctl_max_bytes\": 2048,\n    \"status_max_bytes\": 512\n  },\n  \"rules\": [\n    {\n      \"id\": \"queen-ctl\",\n      \"target\": \"/queen/ctl\"\n    },\n    {\n      \"id\": \"systemd-restart\",\n      \"target\": \"/host/systemd/*/restart\"\n    }\n  ]\n}";

pub const AUDIT_CONFIG: AuditConfig = AuditConfig { enable: false, journal_max_bytes: 8192, decisions_max_bytes: 4096, replay_enable: false, replay_max_entries: 64, replay_ctl_max_bytes: 1024, replay_status_max_bytes: 1024 };

pub const EVENT_PUMP_FDS: [&str; 5] = [
    "serial",
    "timer",
    "ipc",
    "net-console",
    "ninedoor",
];

pub const INITIAL_AUDIT_LINES: [&str; 19] = [
    "manifest.schema=1.2",
    "manifest.profile=virt-aarch64",
    "manifest.sha256=6f58dd705b235b26f0b3524f4a5d632d664015be6338c06e4953257ea0c83413",
    "manifest.tickets=3",
    "manifest.namespaces=0 role_isolation=true",
    "manifest.secure9p.msize=8192",
    "manifest.secure9p.walk_depth=8",
    "manifest.secure9p.tags_per_session=16",
    "manifest.secure9p.batch_frames=1",
    "manifest.secure9p.short_write.policy=reject",
    "telemetry.ring_bytes_per_worker=1024",
    "telemetry.frame_schema=legacy-plaintext",
    "telemetry.cursor.retain_on_boot=false",
    "manifest.cache.kernel_ops=true",
    "manifest.cache.dma_clean=true",
    "manifest.cache.dma_invalidate=true",
    "manifest.cache.unify_instructions=false",
    "manifest.features.net_console=true",
    "event_pump.fds=serial,timer,ipc,net-console,ninedoor",
];

